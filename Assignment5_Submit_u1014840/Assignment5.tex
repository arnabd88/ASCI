\documentclass{article}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphicx}
\usepackage[margin=1in]{geometry}
\usepackage{fancyhdr}
\usepackage{float}
\usepackage{longtable}
\newcommand{\bx}{{\bf x}}
\newcommand{\bw}{{\bf w}}
\newcommand{\bb}{{\bf b}}
\newcommand{\bv}{{\bf v}}
\newcommand{\by}{{\bf y}}
\setlength{\parindent}{0pt}
\setlength{\parskip}{5pt plus 1pt}
\setlength{\headheight}{13.6pt}
\newcommand\question[2]{\vspace{.25in}\hrule\textbf{#1: #2}\hrule\vspace{.10in}}
\renewcommand\part[1]{\vspace{.10in}\textbf{(#1)}}
\newcommand\algo{\vspace{.10in}\textbf{Algorithm: }}
\newcommand\correctness{\vspace{.10in}\textbf{Correctness: }}
\newcommand\runtime{\vspace{.10in}\textbf{Running time: }}
\newcommand\pseudoCode{\vspace{.10in}\textbf{PseudoCode: }}
\newcommand*{\perm}[2]{{}^{#1}\!P_{#2}}
\newcommand*{\comb}[2]{{}^{#1}\!C_{#2}}
%\pagestyle{fancyplain}
%\lhead{\textbf{\NAME\ (\UID)}}
%\chead{\textbf{Hw\HWNUM}}
%\rhead{CS 6350, \today}
\title{CS6210 - Homework/Assignment-5}
\author{Arnab Das(u1014840)}
\usepackage[utf8]{inputenc}
\begin{document}
  \pagenumbering{gobble}
  \maketitle
  \newpage
  \pagenumbering{arabic}
  \newcommand\NAME{ARNAB DAS}
  \newcommand\UID{uxxxxxxx}
  \newcommand\HWNUM{4}



\question{8}{Chapter-11: Question-3}
Let $f \in C^3[a,b]$ be given at equidistant points, $x_i = a + ih,$ where $i=0,1,2, \dots, n$ and $nh = b-a$. $f^\prime(a)$ is given as well. \newline

\part{a} Construct an algorithm for $C^1$ continuous quadratic interpolation: \newline
\[ v(x) = S_i(x) = a_i + b_i(x - x_i) + c_i(x - x_i)^2 ; x_i \leq x \leq x_{i+1}\]
That is an algorithm to determine the 3n coefficients. \newline

\algo
 The polynomial $S_i(x)$ in the interval $x_i \leq x \leq x_{i+1}$ will match the function value exactly. So, we have our first condition as:
	\[S_i(x_i) = a_i = f(x_i) \]
Thus, we have n equations in n variables due to this.
This gives us all the n $a_i$ values. \newline

Also, since $S_i(x)$ is valid in the interval $x_i \leq x \leq x_{i+1}$, hence it should satisfy the function value at $x_{i+1}$ as well. Thus we have our next condition as: 
\[ S_i(x_{i+1}) = f(x_{i+1}) \]
\[ a_i + b_i(x_{i+1} - x_i) + c_i(x_{i+1} - x_i)^2 = f(x_{i+1})\]
since, $x_{i+1} - x_i = h$, we get:
\[ b_i h + c_i h^2 = a_{i+1} - a_i\]
This gives us n equations in 2n variables. In combination with the above we get 2n equations in 3n variables. \newline

Next, since we want the interpolant to be $C^1$ continuous and the given fucntion is $C^3$, hence, the first derivative of $S_i(x_i)$ should match the first derivative of the function at $x_i$. Thus, we get: 
\[ S_{i}^\prime(x_i) = f^\prime(x_i) \]
\[ b_i = f^\prime(x_i)\]

Also, the derivatives should match at $x_{i+1}$. Hence, 
\[ S_i^\prime(x_{i+1}) = f^\prime(x_{i+1})\]
\[ b_i + 2c_i(x_{i+1} - x_i) = f^\prime(x_{i+1})\]
\[ b_i + 2c_i h = f^\prime(x_{i+1})\]

There is a certain pattern that emerges. If we know the derivative value at $x_i$, we can use it further to compute the derivative value at $x_{i+1}$. Since, we need to evaluate all the derivative values exceopt the first one, let us denote the derivative with the variable $d_i$. \newline
Thus, from the above relations we have the following set of equations:

n equations for
\[ a_i = f(x_i)\]

nequations for
\[ b_i h + ci h^2 - (a_{i+1} - a_i) = 0\]

n equations for 
\[ b_i - d_i = 0\]

(n-1) equations for 
\[ b_i + 2c_i h - d_{i+1} = 0 \]

1 equations for the derivative given at x=a, that is $d_0$
\[ d_0 = f(a)\]

Thus, in total we have 4n variables with 4n equations which can be solved to get the 3n coefficients $\{a_i, b_i, c_i\}$ and the derivatives $d_i$. \newline


 \part{b} The error estimate for an n-degree interpolate, $p_n(x)$, with respect to the original function, $f(x)$, is expressed as: 
 \[ f(x) - p_n(x) = \dfrac{f^{(n+1)}(\zeta)}{(n+1)!} \prod_{i=0}^n (x - x_i)\]

 For piecewise quadratic interpolant , $v(x) = S_i(x)$, we have n=2. Hence, we get,
 \begin{equation}
  |f(x) - v(x)| \leq (x - x_{i-1})(x - x_i) \max_{a \leq \zeta \leq b} \dfrac{f^3(\zeta)}{3!} 
  \label{eq:err}
 \end{equation}
 That is the 3rd derivative is bounded by its max value at a point over the entire interval [a,b]. 
 For the term, $(x-x_{i-1})(x - x_i)$, the maximum occurs at the midpoint of the interval , that is, at $\dfrac{x_{i-1} + x_i}{2}$. Thus, we get: \newline
 \[ |(x - x_{i-1})(x - x_i)| \leq \bigg ( \dfrac{x_i - x_{i-1})}{2} \bigg )^2 \]
 and since, $x_i - x_{i-1} = h$, we get
 \[ |(x - x_{i-1})(x - x_i)| \leq \bigg ( \dfrac{h}{2} \bigg )^2 \]

 Plugging this back to $\eqref{eq:err}$, we get the following error bound: \newline
 \[ ErrorBound = |f(x) - v(x)| \leq \dfrac{h^2}{24} \max_{a \leq \zeta \leq b} |f^3(\zeta)|\]








 \question{9}{Chapter-11: Question-12}
Derive a B-spline basis representation for piecewise linear interpolation and for piecewise cubic interpolation: \newline

For (n+1) interpolating  points and degree (k-1), the bspline representation is written as: \newline
\begin{equation}
  P(u) = \sum_{i=0}^n pi N_{i,k}(u)
  \label{eq:bsum}
\end{equation}
 where $N_{i,k}$ are the bspline basis functions and (k-1) is the degree of the curve. Hence, for a piece-wise linear interpolant, the degree of the curve is 1, hence $k=2$. Thus, we have (n+1) interpolating points and k=2. \newline
The idea of bspline formulation us to  generate curve that are affected locally by the control points. So, if a point is changed, the curve formulation will change locally, and not cause changes in the entire curve unlike bezier curves. The entire interval of points $\{ p_0, p_1, \dots, p_n\}$ is divided into a sequence of knots $(t_0, t_1, \dots, t_r)$, such that the effect of a point will have its control in a knot region $[t_{i-1}, t_i]$ and not anywhere else: \newline
The basis function, $N_{i,k}$, is defined as :\newline

\begin{equation}
   N_{i,k}(u) = \dfrac{(u - t_i) N_{i,k-1}(u)}{t_{i+k} - t_i} + \dfrac{(t_{i+k} - u)N_{i+1,k-1}(u)}{t_{i+k} - t_{i+1}}
  \label{eq:basis}
\end{equation}

The base case of the basis functions is given as:
\[ N_{i,1}(u) = 1; t_i \leq u < t_{i+1}\]
\[ = 0 ; otherwise\]

This allows for the termination condition of the recursion defined in $\eqref{eq:basis}$: \newline

In general, the knot values, $t_i$ are defined as: \newline
\[ t_i = 0; i < k\]
\[ t_i = i-k+1; k \leq i \leq n\]
\[ t_i = n-k+2; i > n\]

For the piecewise linear case, the value of $k=2$, hence the above relations translate to: 
\[ t_i = 0; i < 2\]
\[ t_i = i-1; 2 \leq i \leq n\]
\[ t_i = n; i > n\]

Thus , the set of $(n+k+1) = (n+3)$ knot values will be: \newline
\[ t = (0,0,1,2, \dots, n-1, n,n)\]

$\eqref{eq:bsum}$ in this case translates to : \newline
\[ P(u) = \sum_{i=0}^n p_i N_{i,2}(u) = p_0 N_{0,2}(u) + p_1 N_{1,2}(u) + \dots + p_i N_{i,2}(u) + \dots + p_n N_{n,2}(u) \]

where, the basis function $N_{i,2}$ in this case will be : \newline
\begin{equation}
   N_{i,2}(u) = \dfrac{(u - t_i) N_{i,1}(u)}{t_{i+2} - t_i} + \dfrac{(t_{i+2} - u)N_{i+1,1}(u)}{t_{i+2} - t_{i+1}}
   \label{eq:linbasis}
\end{equation}
Here, the base cases of the recursion will become: \newline
$N_{0,1} = 1 $ if $t_0 \leq u < t_1 $ or $0 \leq u < 0$ \newline
$N_{0,1} = 0, otherwise$, \newline
$N_{0,1} = 0$ \newline \newline
$N_{1,1} = 1$ if $t_1 \leq u < t2$ or $0 \leq u < 1$ \newline
$N_{1,1} = 0$, otherwise \newline \newline
$N_{2,1} = 1$ if $t_2 \leq u < t_3$ or $1 \leq u < 2$ \newline
$N_{2,1} = 0$, otherwise \newline \newline
$\dots$ \newline
$N_{n,1} = 1$ if $t_n \leq u < t_{n+1}$ or $n-1 \leq u < n$  \newline
$N_{n,1} = 0$, otherwise \newline \newline

The above base cases plugged into the recursion of the $eqref{eq:linbasis}$ gives the representation for the bspline basis function for piecewise linear. (Answer). \newline

For the case of the piecewise cubic hermiote interpolant, we have a degree 3 interpolant. Hence, (k-1) is 3, thus k=4. Hence, the relation for deriving the knot values will become: \newline
\[ t_i = 0; i < 4\]
\[ t_i = i-3; 4 \leq i \leq n \]
\[ t_i = n-2; i > n\]

Thus, the set of $(n+k+1) = (n+5)$ knot values will be: \newline
\[ t = (0,0,0,0,1,2, \dots, n-3, n-2,n-2,n-2,n-2)\]

$\eqref{eq:bsum}$ in this case translates to : \newline
\begin{equation}
 P(u) = \sum_{i=0}^n p_0 N_{0,4}(u) + p_1 N_{1,4}(u) + \dots + p_i N_{i,4}(u) + \dots + p_n N_{n,4}(u) 
 \label{eq:cubasis}
\end{equation}

Where the recurssions over the basis functions can be further expanded following the relation(1), to reach the terminal base cases which in these case will be defined as follows: \newline
$N_{0,1} = 1 $ if $t_0 \leq u < t_1$ or $0 \leq u < 0$ \newline
$N_{0,1} = 0$, otherwise, \newline
So, $N_{0,1} = 0$ \newline \newline

$N_{1,1} = 1 $ if $t_1 \leq u < t_2$ or $0 \leq u < 0$ \newline
$N_{1,1} = 0$, otherwise, \newline
So, $N_{1,1} = 0$ \newline \newline

$N_{2,1} = 1 $ if $t_2 \leq u < t_3$ or $0 \leq u < 0$ \newline
$N_{2,1} = 0$, otherwise, \newline
So, $N_{2,1} = 0$ \newline \newline

$N_{3,1} = 1$ if $t_3 \leq u < t_4$ or $0 \leq u < 1$ \newline
$N_{3,1} = 0$, otherwise, \newline \newline

$N_{4,1} = 1$ if $t_4 \leq u < t_5$ or $1 \leq u < 2$ \newline
$N_{4,1} = 0$, otherwise, \newline \newline

$N_{5,1} = 1$ if $t_5 \leq u < t_6$ or $2 \leq u < 3$ \newline
$N_{5,1} = 0$, otherwise, \newline 

$\dots$ \newline

$N_{n,1} = 1$ if $t_n \leq u < t_{n+1}$ or $(n-3) \leq u < (n-2)$ \newline
$N_{n,1} = 0$, otherwise, \newline \newline

Now consider $\eqref{eq:cubasis}$, the basis functions recursively depends exactly on 4 base cases if we break them down as follows: \newline
\[ N_{0,4} : (N_{0,1}, N_{1,1}, N_{2,1}, N_{3,1})\]
\[ N_{1,4} : ( N_{1,1}, N_{2,1}, N_{3,1}, N_{4,1})\]
\[ N_{2,4} : ( N_{2,1}, N_{3,1}, N_{4,1}, N_{5,1})\]
\[ N_{3,4} : ( N_{3,1}, N_{4,1}, N_{5,1}, N_{6,1})\]

and so on, \newline

In the region , $0 \leq u < 1$, only $N_{3,1}=1$, other $N_{i,1}'s$ are zero. Now , $N_{3,1}$ is present only in the recursive list of the basis functions associated with  $(p_0, p_1, p_2, P_3)$. Hence, in the region $0 \leq u < 1$, only these 4 points serve as the control points with local control over the curve. Other points do not have any effect here. Similarly, in the region $1 \leq u < 2$, only $N_{4,1}$ is 1, which is present in the recursive list of the basis functions associated with $(p_1, p_2, p_3,p_4)$. Hence, in the region $1 \leq u < 2$, only these 4 points serve as the local control points. \newline

Thus plugging in the base cases , $N_{i,1}'s$, present in the recursive list of respective basis functions, we obtain the representation of the bspline basis functions. (Answer). \newline











\end{document}
